import{z as e,y as a,E as o,r as l,h as t,o as n,i as u,w as s,j as r,q as d,A as i,u as c}from"./index-BZZEtzn7.js";import{b as p,c as m,_ as f}from"./u-button.CAXpmgrA.js";import{_ as v,a as h,b as _}from"./u-form.FxwdRL8U.js";import{p as g,b,c as x,n as k,_ as w}from"./TCaptcha.Bev9IoG7.js";const y=f(e({__name:"new",setup(e){const f=a({phone:"",code:""}),y=a(),C=a(""),V=a(""),j=a(),F={phone:[{required:!0,message:"请输入手机号",trigger:["change","blur"]},{validator:(e,a,o)=>g.test(a),message:"手机号码不正确",trigger:["change","blur"]}],code:[{required:!0,message:"请输入验证码",trigger:["blur"]}]},T=e=>{C.value=e},q=async()=>""===f.value.phone?i({icon:"none",title:"手机号不能为空"}):g.test(f.value.phone)?j.value.canGetCode?(await b(f.value.phone),void j.value.start()):i({icon:"none",title:"倒计时结束后再发送"}):i({icon:"none",title:"手机号码不正确"});function R(){y.value.validate().then((async e=>{if(e){if(!(await x()))return i({icon:"none",title:"校验失败"});await k(f.value.code,f.value.phone,V.value)}})).catch((()=>i({icon:"none",title:"校验失败"})))}return o((async e=>{(null==e?void 0:e.comfirmToken)&&(V.value=null==e?void 0:e.comfirmToken)})),(e,a)=>{const o=c,i=l(t("up-input"),p),g=l(t("up-form-item"),v),b=l(t("up-code"),w),x=l(t("up-text"),h),k=l(t("up-button"),m),V=l(t("up-form"),_);return n(),u(o,{class:"password pd40"},{default:s((()=>[r(o,{class:"top"},{default:s((()=>[r(o,{class:"title"},{default:s((()=>[d("更换新手机号 ")])),_:1})])),_:1}),r(V,{model:f.value,rules:F,labelPosition:"top",labelWidth:"66",ref_key:"uFormRef",ref:y},{default:s((()=>[r(g,{prop:"phone"},{default:s((()=>[r(i,{modelValue:f.value.phone,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value.phone=e),maxlength:11,placeholder:"请输入新手机号"},null,8,["modelValue"])])),_:1}),r(g,{prop:"code"},{default:s((()=>[r(i,{modelValue:f.value.code,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value.code=e),maxlength:6,placeholder:"请输入验证码"},{suffix:s((()=>[r(b,{seconds:60,ref_key:"uCodeRef",ref:j,onChange:T},null,512),r(x,{onClick:q,color:"#6861FF",text:C.value},null,8,["text"])])),_:1},8,["modelValue"])])),_:1}),r(k,{onClick:R,throttleTime:1e3,color:"#6861FF"},{default:s((()=>[d("提交")])),_:1})])),_:1},8,["model"])])),_:1})}}}),[["__scopeId","data-v-dd9cbb29"]]);export{y as default};
